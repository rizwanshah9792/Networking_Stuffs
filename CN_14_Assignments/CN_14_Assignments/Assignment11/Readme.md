# Mininet Lab: TCP SYN Analysis

## Overview
This lab demonstrates TCP SYN packet analysis and IP spoofing techniques using Mininet. The exercise simulates a DDoS attack scenario where an attacker spoofs multiple IP addresses to send SYN packets to a victim. 

---

## Network Topology

We will use a single switch with 6 hosts:

| Host | Role | IP Address |
|------|------|------------|
| h1 | Attacker | 10.0.0.1 |
| h2 | Victim | 10.0.0.2 |
| h3 | Agent 1 (Spoofed) | 10.0.0.3 |
| h4 | Agent 2 (Spoofed) | 10.0.0.4 |
| h5 | Agent 3 (Spoofed) | 10.0.0.5 |
| h6 | Agent 4 (Spoofed) | 10.0.0.6 |

---

## Step-by-Step Instructions

### Step 1: Create the Topology

Create a single switch topology with 6 hosts using Mininet:

```bash
sudo mn --topo single,6
```

### Step 2: Open Host Terminals

Open xterm terminals for the Attacker (h1) and Victim (h2):

```bash
mininet> xterm h1 h2
```

### Step 3: Setup Victim (h2)

On the **h2 terminal**, start packet capture to monitor incoming SYN packets:

```bash
# Using tcpdump to filter TCP SYN packets
tcpdump -i h2-eth0 -n "tcp[tcpflags] & (tcp-syn) != 0"
```

**Alternative using Wireshark:**
```bash
wireshark &
```
Then apply filter: `tcp.flags.syn == 1`

### Step 4: Prepare Attack Tool (h1)

On the **h1 terminal**, compile the SYN packet crafter:

```bash
gcc syn_crafter.c -o syn_crafter
```

### Step 5: Execute Attack Simulation

Run the following commands on **h1** to send spoofed SYN packets from different agent IPs:

```bash
# Sending as Agent 1 (h3 - 10.0.0.3)
./syn_crafter 10.0.0.3 10.0.0.2

# Sending as Agent 2 (h4 - 10.0.0.4)
./syn_crafter 10.0.0.4 10.0.0.2

# Sending as Agent 3 (h5 - 10.0.0.5)
./syn_crafter 10.0.0.5 10.0.0.2

# Sending as Agent 4 (h6 - 10.0.0.6)
./syn_crafter 10.0.0.6 10.0.0.2
```

**Note:** Each command spoofs a different source IP address while targeting the victim at 10.0.0.2

---

## Step 6: Verify Results

### Expected Output on Victim (h2)

Check the **h2** terminal running tcpdump.  You should see output similar to: 

```
10:00:01 IP 10.0.0.3.12345 > 10.0.0.2.80: Flags [S], seq 0, ...
10:00:02 IP 10.0.0.4.12345 > 10.0.0.2.80: Flags [S], seq 0, ...
10:00:03 IP 10.0.0.5.12345 > 10.0.0.2.80: Flags [S], seq 0, ... 
10:00:04 IP 10.0.0.6.12345 > 10.0.0.2.80: Flags [S], seq 0, ...
```

### Analysis

This confirms that: 
- **h2 (Victim)** received SYN packets appearing to originate from h3, h4, h5, and h6
- All packets were actually generated by **h1 (Attacker)**
- This demonstrates **IP spoofing** mechanics used in DDoS attacks
- The victim cannot determine the true source of the attack

---

## Key Concepts Demonstrated

1. **TCP SYN Packets**: Understanding the first step of the TCP three-way handshake
2. **IP Spoofing**:  Forging source IP addresses in packet headers
3. **DDoS Attack Simulation**: Multiple spoofed sources targeting a single victim
4. **Packet Capture and Analysis**: Using tcpdump/Wireshark to monitor network traffic

---

## Security Implications

⚠️ **Warning**: This lab is for educational purposes only. IP spoofing and DDoS attacks are illegal when performed on networks without authorization. 

- Modern networks implement ingress filtering to prevent IP spoofing
- SYN flood attacks can exhaust victim resources by filling connection tables
- Legitimate traffic may be blocked during such attacks

---

## Cleanup

To exit Mininet and clean up: 

```bash
mininet> exit
sudo mn -c
```

---

## Prerequisites

- Linux system with Mininet installed
- Root/sudo privileges
- Basic understanding of TCP/IP protocols
- C compiler (gcc) installed
- tcpdump or Wireshark installed

---

## Troubleshooting

### Issue:  Permission denied when running syn_crafter
**Solution**:  Run with sudo privileges
```bash
sudo ./syn_crafter 10.0.0.3 10.0.0.2
```

### Issue: No packets visible on victim
**Solution**: Ensure tcpdump is running before launching the attack

### Issue: Compilation errors
**Solution**: Ensure all required headers and libraries are installed
```bash
sudo apt-get install build-essential
```

---

## References

- [Mininet Documentation](http://mininet.org/)
- [TCP Protocol Specification - RFC 793](https://tools.ietf.org/html/rfc793)
- [DDoS Attack Mitigation Techniques](https://www.cloudflare.com/learning/ddos/ddos-mitigation/)

---

**Assignment 11 - Computer Networks Lab**  
*Last Updated: December 2025*
