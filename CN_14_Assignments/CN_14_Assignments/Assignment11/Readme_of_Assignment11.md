# **Mininet Lab: TCP SYN Analysis**

## **Step 1: Create the Topology**

We will use a single switch with 6 hosts.

* **h1**: Attacker  
* **h2**: Victim  
* **h3-h6**: These will be the "Agent" IPs we spoof.

Run this command in your main terminal:

sudo mn \--topo single,6

## **Step 2: Open Terminals**

Open the terminals for the Attacker (h1) and the Victim (h2).

mininet\> xterm h1 h2

## **Step 3: Identify IPs**

In Mininet, the IPs usually follow the host number:

* h1: 10.0.0.1 (Attacker)  
* h2: 10.0.0.2 (Victim)  
* h3: 10.0.0.3 (Agent 1\)  
* h4: 10.0.0.4 (Agent 2\)  
* h5: 10.0.0.5 (Agent 3\)  
* h6: 10.0.0.6 (Agent 4\)

## **Step 4: Setup Victim (h2)**

Start Wireshark or TCPDump on the victim to observe the incoming attack traffic.

\# In h2 terminal  
tcpdump \-i h2-eth0 \-n "tcp\[tcpflags\] & (tcp-syn) \!= 0"

*This command filters specifically for TCP packets with the SYN flag set.*

## **Step 5: Execute Attack Simulation (h1)**

On the Attacker (h1), compile and run the packet crafter. We will manually simulate the "flood" by sending packets from different spoofed IPs.

1. **Compile:**  
   gcc syn\_crafter.c \-o syn\_crafter

2. Launch the Spoofed Packets:  
   Run the command 4 times, changing the source IP each time to match the "Agent" IPs (h3 through h6).  
   \# Sending as Agent 1 (h3)  
   ./syn\_crafter 10.0.0.3 10.0.0.2

   \# Sending as Agent 2 (h4)  
   ./syn\_crafter 10.0.0.4 10.0.0.2

   \# Sending as Agent 3 (h5)  
   ./syn\_crafter 10.0.0.5 10.0.0.2

   \# Sending as Agent 4 (h6)  
   ./syn\_crafter 10.0.0.6 10.0.0.2

## **Step 6: Verify Results**

Check the **h2 (Victim)** terminal running TCPDump. You should see output similar to this:

10:00:01 IP 10.0.0.3.12345 \> 10.0.0.2.80: Flags \[S\], seq 0, ...  
10:00:02 IP 10.0.0.4.12345 \> 10.0.0.2.80: Flags \[S\], seq 0, ...  
10:00:03 IP 10.0.0.5.12345 \> 10.0.0.2.80: Flags \[S\], seq 0, ...  
10:00:04 IP 10.0.0.6.12345 \> 10.0.0.2.80: Flags \[S\], seq 0, ...

This confirms that **h2** received SYN packets that appeared to come from h3, h4, h5, and h6, even though they were all generated by **h1**. This demonstrates the mechanics of IP spoofing used in DDoS attacks.